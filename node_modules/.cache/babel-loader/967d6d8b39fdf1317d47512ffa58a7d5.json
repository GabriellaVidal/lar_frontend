{"ast":null,"code":"var _jsxFileName = \"/home/gabriella/Documentos/lar-ureto-front-end/src/pages/Actions.js\";\nimport React, { Component } from 'react';\nimport { isAuthenticated } from '../services/auth';\nimport { Redirect } from 'react-router';\nimport swal from 'sweetalert';\nimport Footer from '../components/Footer';\nimport Example from '../components/plugin/example';\nimport CreateFunction from '../components/plugin/createFunction';\nimport { DndProvider } from 'react-dnd';\nimport HTML5Backend from 'react-dnd-html5-backend';\nimport { TouchBackend } from 'react-dnd-touch-backend';\nimport api from \"../services/api\";\nimport \"../components/Action.css\";\nconst hasNative = document && (document.elementsFromPoint || document.msElementsFromPoint);\n\nfunction getDropTargetElementsAtPoint(x, y, dropTargets) {\n  return dropTargets.filter(t => {\n    const rect = t.getBoundingClientRect();\n    return x >= rect.left && x <= rect.right && y <= rect.bottom && y >= rect.top;\n  });\n} // use custom function only if elementsFromPoint is not supported\n\n\nconst backendOptions = {\n  getDropTargetElementsAtPoint: !hasNative && getDropTargetElementsAtPoint\n};\n\nclass Actions extends Component {\n  constructor(props) {\n    super(props);\n\n    this.populateAuthorization = async () => {\n      const request = await api.put('/authorization/' + this.id);\n\n      if (request !== undefined) {\n        this.setState({\n          authorization: request.data.authorization\n        });\n      }\n    };\n\n    this.id = this.props.location.search.replace(\"?\", \"\");\n    this.state = {\n      selectedIdUser: \"\",\n      selectedIdDevice: \"\",\n      devices: [],\n      selectedDevice: \"\",\n      users: [],\n      error: \"\",\n      authorization: []\n    };\n  }\n\n  async componentDidMount() {\n    if (isAuthenticated()) {\n      document.title = \"Programar com blocos\";\n      await this.populateAuthorization(); // this.subscribe();\n    }\n  } // async subscribe() {\n  //     // setInterval(function() { \n  //         const response = await api.put(\"/device/retornoCarrinho/\", {\n  //             device: this.state.authorization.device_id, \n  //             user: this.state.authorization.user_id\n  //         });\n  //         console.log(response);\n  //         console.log(response.data);\n  //     // }, 0);\n  // }\n\n\n  async criarFuncao() {\n    console.log(\"kjfcd\");\n    document.getElementId(\"function-box\").setAttribute('style', 'display: block');\n    ;\n  }\n\n  async playCarrinho() {\n    const items = document.getElementById(\"boxPreenchido\").childNodes; // const buttons = document.getElementById(\"BoxPreenchido\").getElementsByTagName( 'button' );\n\n    const botaoPlay = document.getElementById(\"botaoPlay\");\n    botaoPlay.setAttribute('disabled', true);\n    const comandos = [];\n\n    for (var i = items.length - 1; i >= 0; i--) {\n      if (items[i].classList.contains('btn')) {\n        const comandoNome = items[i].getAttribute('name');\n\n        if (comandoNome == 'multiple') {\n          const quantidade = items[i + 1].value;\n\n          for (var j = 0; j < parseInt(quantidade) - 1; j++) {\n            comandos.push({\n              'comando': items[i - 2].getAttribute('name'),\n              'index': i,\n              'classOrigin': items[i].classList[1],\n              'type': comandoNome\n            });\n          }\n\n          items[i + 1].setAttribute('disabled', true);\n          items[i].classList.remove(\"btn-warning\");\n          items[i].classList.add(\"btn-default\");\n        } else {\n          comandos.push({\n            'comando': items[i].getAttribute('name'),\n            'index': i,\n            'classOrigin': items[i].classList[1],\n            'type': comandoNome\n          });\n          items[i].classList.remove(\"btn-success\");\n          items[i].classList.add(\"btn-default\");\n        }\n      }\n    }\n\n    comandos.reverse();\n    console.log(comandos);\n\n    if (comandos.length > 0) {\n      for (var i in comandos) {\n        const response = await api.put(\"/device/movimentar/\", {\n          device: this.state.authorization.device_id,\n          user: this.state.authorization.user_id,\n          value: JSON.stringify(comandos[i].comando)\n        });\n        console.log(response);\n        console.log(response.data);\n\n        if (response.data.subscribe == 'feito') {\n          items[comandos[i].index].classList.remove(\"btn-default\");\n          items[comandos[i].index].classList.add(comandos[i].classOrigin);\n\n          if (comandos[i].type == 'multiple') {\n            items[comandos[i].index + 1].removeAttribute('disabled');\n          }\n        }\n\n        if (i == comandos.length - 1) {\n          botaoPlay.removeAttribute('disabled');\n          this.finalizado();\n        }\n      }\n    } else {\n      swal(\"OPs!\", \"Comandos não foram enviados!\", \"error\");\n    }\n  }\n\n  async finalizado() {\n    const response = await api.put(\"/device/movimentar/\", {\n      device: this.state.authorization.device_id,\n      user: this.state.authorization.user_id,\n      value: JSON.stringify(\"finalizado\")\n    });\n    console.log('response.data.subscribe', response.data.subscribe);\n\n    if (response.data.subscribe == 'feito' || response.data.subscribe == 'VERMELHO' || response.data.subscribe == 'VERDE' || response.data.subscribe == 'AZUL' || response.data.subscribe == 'PRETO') {\n      const mensagem = response.data.subscribe != 'feito' ? \"Trajeto Finalizado! Você checgou no destino \" + response.data.subscribe + \"! \" : \"Trajeto Finalizado!\";\n      swal(\"Parabéns!\", mensagem, \"success\");\n    } else {\n      swal(\"OPs!\", \"Problemas ao finalizar\", \"error\");\n    }\n  }\n\n  async clickAndar(deviceId, userId) {\n    let device = deviceId;\n    let user = userId;\n    const enabled = \"andar\";\n\n    try {\n      const response = await api.put(\"/device/movimentar/\", {\n        device: device,\n        user: user,\n        value: enabled\n      });\n\n      if (response.data.result === \"ok\") {\n        alert(\"Andar com sucesso!\");\n      } // console.log(response.data); \n\n    } catch (err) {\n      // console.log(err);\n      this.setState({\n        error: \"Houve um problema no cadastro de autorização.\"\n      });\n    }\n\n    if (this.state.error !== 0) {\n      // alert(this.state.error);\n      console.log(\"Error:\" + this.state.error + \"!\");\n    }\n  }\n\n  async clickParar(deviceId, userId) {\n    let device = deviceId;\n    let user = userId;\n    const enabled = \"parar\";\n\n    try {\n      const response = await api.put(\"/device/movimentar/\", {\n        device: device,\n        user: user,\n        value: enabled\n      });\n\n      if (response.data.result === \"ok\") {\n        alert(\"Parar sucesso!\");\n      } // console.log(response.data); \n\n    } catch (err) {\n      // console.log(err);\n      this.setState({\n        error: \"Houve um problema no cadastro de autorização.\"\n      });\n    }\n\n    if (this.state.error !== 0) {\n      // alert(this.state.error);\n      console.log(\"Error:\" + this.state.error + \"!\");\n    }\n  }\n\n  async clickDireita(deviceId, userId) {\n    let device = deviceId;\n    let user = userId;\n    const enabled = \"andarDireita\";\n\n    try {\n      const response = await api.put(\"/device/movimentar/\", {\n        device: device,\n        user: user,\n        value: enabled\n      });\n\n      if (response.data.result === \"ok\") {\n        alert(\"Virar com sucesso!\");\n      } // console.log(response.data); \n\n    } catch (err) {\n      // console.log(err);\n      this.setState({\n        error: \"Houve um problema no cadastro de autorização.\"\n      });\n    }\n\n    if (this.state.error !== 0) {\n      // alert(this.state.error);\n      console.log(\"Error:\" + this.state.error + \"!\");\n    }\n  }\n\n  async clickEsquerda(deviceId, userId) {\n    let device = deviceId;\n    let user = userId;\n    const enabled = \"andarEsquerda\";\n\n    try {\n      const response = await api.put(\"/device/movimentar/\", {\n        device: device,\n        user: user,\n        value: enabled\n      });\n\n      if (response.data.result === \"ok\") {\n        alert(\"Virar com sucesso!\");\n      } // console.log(response.data); \n\n    } catch (err) {\n      // console.log(err);\n      this.setState({\n        error: \"Houve um problema no cadastro de autorização.\"\n      });\n    }\n\n    if (this.state.error !== 0) {\n      // alert(this.state.error);\n      console.log(\"Error:\" + this.state.error + \"!\");\n    }\n  }\n\n  async clickRe(deviceId, userId) {\n    let device = deviceId;\n    let user = userId;\n    const enabled = \"re\";\n\n    try {\n      const response = await api.put(\"/device/movimentar/\", {\n        device: device,\n        user: user,\n        value: enabled\n      });\n\n      if (response.data.result === \"ok\") {\n        alert(\"Virar com sucesso!\");\n      } // console.log(response.data); \n\n    } catch (err) {\n      // console.log(err);\n      this.setState({\n        error: \"Houve um problema no cadastro de autorização.\"\n      });\n    }\n\n    if (this.state.error !== 0) {\n      // alert(this.state.error);\n      console.log(\"Error:\" + this.state.error + \"!\");\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 13\n      }\n    }, !isAuthenticated() ? /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 21\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container cardauth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(DndProvider, {\n      backend: HTML5Backend,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Example, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(DndProvider, {\n      backend: TouchBackend,\n      options: backendOptions,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Example, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-sm-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-info\",\n      id: \"botaoPlay\",\n      onClick: () => this.playCarrinho(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-play\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 41\n      }\n    })))))), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default Actions;","map":{"version":3,"sources":["/home/gabriella/Documentos/lar-ureto-front-end/src/pages/Actions.js"],"names":["React","Component","isAuthenticated","Redirect","swal","Footer","Example","CreateFunction","DndProvider","HTML5Backend","TouchBackend","api","hasNative","document","elementsFromPoint","msElementsFromPoint","getDropTargetElementsAtPoint","x","y","dropTargets","filter","t","rect","getBoundingClientRect","left","right","bottom","top","backendOptions","Actions","constructor","props","populateAuthorization","request","put","id","undefined","setState","authorization","data","location","search","replace","state","selectedIdUser","selectedIdDevice","devices","selectedDevice","users","error","componentDidMount","title","criarFuncao","console","log","getElementId","setAttribute","playCarrinho","items","getElementById","childNodes","botaoPlay","comandos","i","length","classList","contains","comandoNome","getAttribute","quantidade","value","j","parseInt","push","remove","add","reverse","response","device","device_id","user","user_id","JSON","stringify","comando","subscribe","index","classOrigin","type","removeAttribute","finalizado","mensagem","clickAndar","deviceId","userId","enabled","result","alert","err","clickParar","clickDireita","clickEsquerda","clickRe","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { isAuthenticated } from '../services/auth'; \nimport { Redirect } from 'react-router'\nimport swal from 'sweetalert';\nimport Footer from '../components/Footer';\n\n\nimport Example from '../components/plugin/example';\nimport CreateFunction from '../components/plugin/createFunction';\nimport { DndProvider } from 'react-dnd'\nimport HTML5Backend from 'react-dnd-html5-backend'\nimport { TouchBackend } from 'react-dnd-touch-backend'\n\nimport api from \"../services/api\";\n\nimport \"../components/Action.css\" \n\nconst hasNative =\ndocument && (document.elementsFromPoint || document.msElementsFromPoint)\n\nfunction getDropTargetElementsAtPoint(x, y, dropTargets) {\nreturn dropTargets.filter(t => {\n  const rect = t.getBoundingClientRect()\n  return (\n    x >= rect.left &&\n    x <= rect.right &&\n    y <= rect.bottom &&\n    y >= rect.top\n  )\n})\n}\n\n// use custom function only if elementsFromPoint is not supported\nconst backendOptions = {\ngetDropTargetElementsAtPoint: !hasNative && getDropTargetElementsAtPoint,\n}\n\nclass Actions extends Component { \n    constructor(props){ \n        super(props);\n        this.id = this.props.location.search.replace(\"?\", \"\");\n        this.state = {\n            selectedIdUser: \"\",\n            selectedIdDevice: \"\", \n            devices: [],\n            selectedDevice: \"\",\n            users: [], \n            error: \"\",\n            authorization: []\n        };\n    }\n\n    populateAuthorization = async () => {\n        const request = await api.put('/authorization/'+this.id);\n        if(request !== undefined){\n            this.setState({authorization: request.data.authorization}); \n        }\n    }\n\n\n    async componentDidMount() {\n        if (isAuthenticated()) {\n            document.title = \"Programar com blocos\";\n            await this.populateAuthorization(); \n            // this.subscribe();\n        }\n    }\n\n    // async subscribe() {\n    //     // setInterval(function() { \n    //         const response = await api.put(\"/device/retornoCarrinho/\", {\n    //             device: this.state.authorization.device_id, \n    //             user: this.state.authorization.user_id\n    //         });\n    //         console.log(response);\n    //         console.log(response.data);\n    //     // }, 0);\n    // }\n    \n    async criarFuncao() {\n        console.log(\"kjfcd\");\n        document.getElementId(\"function-box\")\n            .setAttribute('style', 'display: block');;\n    }\n\n    async playCarrinho() {\n        const items = document.getElementById(\"boxPreenchido\").childNodes;\n        // const buttons = document.getElementById(\"BoxPreenchido\").getElementsByTagName( 'button' );\n        const botaoPlay = document.getElementById(\"botaoPlay\");\n        botaoPlay.setAttribute('disabled', true);\n\n        const comandos = [];\n        for (var i = items.length - 1; i >= 0; i--) {\n            if(items[i].classList.contains('btn')){\n                const comandoNome = items[i].getAttribute('name');\n                if(comandoNome == 'multiple'){\n                    const quantidade = items[i+1].value;\n                    for (var j = 0; j < parseInt(quantidade) - 1; j++) {\n                        comandos.push({\n                            'comando':items[i-2].getAttribute('name'),\n                            'index': i,\n                            'classOrigin': items[i].classList[1],\n                            'type': comandoNome\n                        });\n                    }\n                    items[i+1].setAttribute('disabled', true);\n                    items[i].classList.remove(\"btn-warning\");\n                    items[i].classList.add(\"btn-default\");\n                } else {\n                    comandos.push({\n                        'comando': items[i].getAttribute('name'),\n                        'index': i,\n                        'classOrigin': items[i].classList[1],\n                        'type': comandoNome\n                    });\n                    items[i].classList.remove(\"btn-success\");\n                    items[i].classList.add(\"btn-default\");\n                }\n            }\n        }\n        comandos.reverse()\n        console.log(comandos)\n        if(comandos.length > 0){\n            for (var i in comandos){\n                const response = await api.put(\"/device/movimentar/\", {\n                    device: this.state.authorization.device_id, \n                    user: this.state.authorization.user_id, \n                    value: JSON.stringify(comandos[i].comando)\n                });\n                console.log(response);\n                console.log(response.data);\n                if(response.data.subscribe == 'feito'){\n                    items[comandos[i].index].classList.remove(\"btn-default\");\n                    items[comandos[i].index].classList.add(comandos[i].classOrigin);\n                    if(comandos[i].type == 'multiple'){\n                        items[comandos[i].index+1].removeAttribute('disabled');\n                    }\n                }\n                if(i == comandos.length-1){\n                    botaoPlay.removeAttribute('disabled');\n                    this.finalizado();\n                }\n            }\n        } else{\n           swal(\"OPs!\", \"Comandos não foram enviados!\", \"error\");  \n        }\n    }\n\n    async finalizado(){\n        const response = await api.put(\"/device/movimentar/\", {\n                    device: this.state.authorization.device_id, \n                    user: this.state.authorization.user_id, \n                    value: JSON.stringify(\"finalizado\")\n                });\n        console.log('response.data.subscribe', response.data.subscribe);\n        if(response.data.subscribe == 'feito' || response.data.subscribe == 'VERMELHO' || response.data.subscribe == 'VERDE' || response.data.subscribe == 'AZUL' || response.data.subscribe == 'PRETO'){\n            const mensagem = response.data.subscribe != 'feito' ? \"Trajeto Finalizado! Você checgou no destino \"+response.data.subscribe+\"! \" : \"Trajeto Finalizado!\";\n            swal(\"Parabéns!\", mensagem, \"success\");\n        } else {\n            swal(\"OPs!\", \"Problemas ao finalizar\", \"error\");\n        }\n    }\n\n    async clickAndar(deviceId, userId){\n\n        let device = deviceId; \n        let user = userId; \n        const enabled = \"andar\"; \n        try {\n            const response = await api.put(\"/device/movimentar/\", {device: device, user: user, value: enabled});\n\n            if ( response.data.result === \"ok\" ){\n                alert(\"Andar com sucesso!\"); \n            }\n            // console.log(response.data); \n                \n        } catch (err) {\n            // console.log(err);\n            this.setState({\n            error:\n                \"Houve um problema no cadastro de autorização.\"\n            });\n        }\n\n        if (  this.state.error !== 0  ){\n            // alert(this.state.error);\n            console.log(\"Error:\"+this.state.error+\"!\");\n        } \n    }\n\n    async clickParar(deviceId, userId){\n\n        let device = deviceId; \n        let user = userId; \n        const enabled = \"parar\"; \n        try {\n            const response = await api.put(\"/device/movimentar/\", {device: device, user: user, value: enabled});\n\n            if ( response.data.result === \"ok\" ){\n                alert(\"Parar sucesso!\"); \n            }\n            // console.log(response.data); \n                \n        } catch (err) {\n            // console.log(err);\n            this.setState({\n            error:\n                \"Houve um problema no cadastro de autorização.\"\n            });\n        }\n\n        if (  this.state.error !== 0  ){\n            // alert(this.state.error);\n            console.log(\"Error:\"+this.state.error+\"!\");\n        } \n    }\n\n    async clickDireita(deviceId, userId){\n\n        let device = deviceId; \n        let user = userId; \n        const enabled = \"andarDireita\"; \n        try {\n            const response = await api.put(\"/device/movimentar/\", {device: device, user: user, value: enabled});\n\n            if ( response.data.result === \"ok\" ){\n                alert(\"Virar com sucesso!\"); \n            }\n            // console.log(response.data); \n                \n        } catch (err) {\n            // console.log(err);\n            this.setState({\n            error:\n                \"Houve um problema no cadastro de autorização.\"\n            });\n        }\n\n        if (  this.state.error !== 0  ){\n            // alert(this.state.error);\n            console.log(\"Error:\"+this.state.error+\"!\");\n        } \n    }\n\n    async clickEsquerda(deviceId, userId){\n\n        let device = deviceId; \n        let user = userId; \n        const enabled = \"andarEsquerda\"; \n        try {\n            const response = await api.put(\"/device/movimentar/\", {device: device, user: user, value: enabled});\n\n            if ( response.data.result === \"ok\" ){\n                alert(\"Virar com sucesso!\"); \n            }\n            // console.log(response.data); \n                \n        } catch (err) {\n            // console.log(err);\n            this.setState({\n            error:\n                \"Houve um problema no cadastro de autorização.\"\n            });\n        }\n\n        if (  this.state.error !== 0  ){\n            // alert(this.state.error);\n            console.log(\"Error:\"+this.state.error+\"!\");\n        } \n    }\n\n    async clickRe(deviceId, userId){\n\n        let device = deviceId; \n        let user = userId; \n        const enabled = \"re\"; \n        try {\n            const response = await api.put(\"/device/movimentar/\", {device: device, user: user, value: enabled});\n\n            if ( response.data.result === \"ok\" ){\n                alert(\"Virar com sucesso!\"); \n            }\n            // console.log(response.data); \n                \n        } catch (err) {\n            // console.log(err);\n            this.setState({\n            error:\n                \"Houve um problema no cadastro de autorização.\"\n            });\n        }\n\n        if (  this.state.error !== 0  ){\n            // alert(this.state.error);\n            console.log(\"Error:\"+this.state.error+\"!\");\n        } \n    }\n\n\n    render() {\n        return ( \n            <div >\n                { (!isAuthenticated() ) ? \n                    <Redirect to=\"/login\"/> : \n                    <div className=\"container cardauth\">\n                        <div className=\"row\">\n                            <DndProvider backend={HTML5Backend}>\n                                <Example/>\n                            </DndProvider>\n                            <DndProvider backend={TouchBackend} options={backendOptions}>\n                                <Example/>\n                            </DndProvider>\n                        </div>\n                        <div className=\"row\">\n                            <div className=\"container\">\n                                <div className=\"col-sm-2\">\n                                    <button type=\"button\" className=\"btn btn-info\" id=\"botaoPlay\" onClick={()=> this.playCarrinho()}>\n                                        <i className=\"fa fa-play\" aria-hidden=\"true\"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                }\n                <Footer></Footer>\n            </div>\n        );\n    }\n}\n\nexport default Actions; "]},"metadata":{},"sourceType":"module"}